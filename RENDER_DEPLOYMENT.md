# Render Deployment Guide

This guide will help you deploy the Tourism Bot project on Render.

## Prerequisites

1. A [Render account](https://render.com) (free tier available)
2. Your Telegram Bot Token from [@BotFather](https://t.me/botfather)
3. This project pushed to a Git repository (GitHub, GitLab, or Bitbucket)

## Deployment Steps

### Option 1: Using render.yaml (Recommended)

1. **Push your code to GitHub/GitLab**
   ```bash
   git add .
   git commit -m "Prepare for Render deployment"
   git push origin main
   ```

2. **Connect to Render**
   - Go to [Render Dashboard](https://dashboard.render.com/)
   - Click "New" → "Blueprint"
   - Connect your repository
   - Render will automatically detect `render.yaml`

3. **Configure Environment Variables**
   
   For **tourism-bot-admin** service:
   - `BOT_TOKEN`: Your Telegram bot token
   - `DATABASE_URL`: `sqlite+aiosqlite:///./db.sqlite3` (or use PostgreSQL for production)
   - `ADMIN_USERNAME`: Your admin username (e.g., `admin`)
   - `ADMIN_PASSWORD`: Your admin password
   - `SESSION_SECRET_KEY`: Auto-generated by Render
   
   For **tourism-bot** worker:
   - `BOT_TOKEN`: Your Telegram bot token (same as above)
   - `DATABASE_URL`: Same as admin service

4. **Deploy**
   - Click "Apply" to deploy both services
   - Wait for the build to complete

### Option 2: Manual Setup

#### Deploy Web Admin Panel

1. **Create Web Service**
   - Go to Render Dashboard
   - Click "New" → "Web Service"
   - Connect your repository
   - Configure:
     - **Name**: `tourism-bot-admin`
     - **Environment**: `Python 3`
     - **Build Command**: `pip install -r requirements.txt`
     - **Start Command**: `python web/run_admin.py`

2. **Add Environment Variables**
   - `BOT_TOKEN`: Your bot token
   - `DATABASE_URL`: `sqlite+aiosqlite:///./db.sqlite3`
   - `ADMIN_USERNAME`: `admin`
   - `ADMIN_PASSWORD`: Your secure password
   - `SESSION_SECRET_KEY`: Generate a random string

3. **Deploy**

#### Deploy Telegram Bot Worker

1. **Create Background Worker**
   - Click "New" → "Background Worker"
   - Connect same repository
   - Configure:
     - **Name**: `tourism-bot`
     - **Environment**: `Python 3`
     - **Build Command**: `pip install -r requirements.txt`
     - **Start Command**: `python bot/main.py`

2. **Add Environment Variables**
   - `BOT_TOKEN`: Your bot token (same as web service)
   - `DATABASE_URL`: `sqlite+aiosqlite:///./db.sqlite3`

3. **Deploy**

## Important Notes

### Database Considerations

**SQLite (Current Setup)**
- ⚠️ SQLite on Render uses ephemeral storage
- Data will be lost on each deployment
- Good for testing only

**PostgreSQL (Recommended for Production)**
1. Create a PostgreSQL database on Render
2. Update `DATABASE_URL` to PostgreSQL connection string:
   ```
   postgresql+asyncpg://user:password@host/database
   ```
3. Update requirements.txt:
   ```bash
   # Add to requirements.txt
   asyncpg==0.29.0
   psycopg2-binary==2.9.9
   ```

### Media Files

- Media files are stored in the `media/` directory
- On Render's free tier, uploaded files are ephemeral
- Consider using cloud storage (AWS S3, Cloudinary) for production

### Environment Variables

Never commit `.env` file to Git. Always use Render's environment variables dashboard.

### Monitoring

- Check logs in Render Dashboard → Your Service → Logs
- Monitor bot status and admin panel health

## Post-Deployment

1. **Access Admin Panel**
   - URL: `https://your-service-name.onrender.com/admin`
   - Login with your ADMIN_USERNAME and ADMIN_PASSWORD

2. **Test Bot**
   - Open Telegram
   - Search for your bot
   - Send `/start` command

3. **Add Data**
   - Use admin panel to add cities, excursions, and points of interest

## Troubleshooting

### Bot not responding
- Check worker logs in Render dashboard
- Verify BOT_TOKEN is correct
- Ensure worker service is running

### Admin panel not loading
- Check web service logs
- Verify all environment variables are set
- Check if service is running

### Database errors
- Verify DATABASE_URL format
- Check if database tables are created
- Review startup logs

## Upgrading to Production

1. **Use PostgreSQL** instead of SQLite
2. **Add Redis** for caching (optional)
3. **Use cloud storage** for media files
4. **Set up monitoring** and alerts
5. **Configure custom domain**
6. **Enable auto-deploy** from main branch

## Support

For issues specific to:
- Render platform: [Render Docs](https://render.com/docs)
- This project: Check project documentation in `docs/` folder
